{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap f12993529f08a14f098b","webpack:///./src/index.js","webpack:///./src/MockRestApiServer.js","webpack:///external \"express\"","webpack:///external \"body-parser\"","webpack:///external \"cors\"","webpack:///external \"mock-response-handler\""],"names":[],"mappings":"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","file":"express-mock-rest-api.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"express\"), require(\"body-parser\"), require(\"cors\"), require(\"mock-response-handler\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"express-mock-rest-api\", [\"express\", \"body-parser\", \"cors\", \"mock-response-handler\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"express-mock-rest-api\"] = factory(require(\"express\"), require(\"body-parser\"), require(\"cors\"), require(\"mock-response-handler\"));\n\telse\n\t\troot[\"express-mock-rest-api\"] = factory(root[\"express\"], root[\"body-parser\"], root[\"cors\"], root[\"mock-response-handler\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_5__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap f12993529f08a14f098b\n **/","import {MockRestApiServer} from \"./MockRestApiServer\";\n\nmodule.exports = {\n    MockRestApiServer : MockRestApiServer\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","import express from \"express\";\nimport bodyParser from \"body-parser\";\nimport cors from \"cors\";\nimport {ResponseHandler} from  \"mock-response-handler\";\n\n\nexport class MockRestApiServer {\n\n    constructor(port,mockApiPath,options) {\n        this.started = false;\n        this.options = options;\n        this.port = port;\n        this.mockApiPath = mockApiPath;\n        this.responseHandler = new ResponseHandler();\n        this.server = null;\n    }\n    stop() {\n        if(this.server != null && this.started == true) {\n            this.server.stop();\n        }\n    }\n    start() {\n        var app = express();\n        var corsOptionsDelegate = (req, callback) => {\n            console.log(\"CORS DELEGATE\");\n            callback(null,{ origin: true, credentials : true});\n        };\n        app.use(cors(corsOptionsDelegate));\n        app.set('etag', false);\n        app.set(\"port\", this.port);\n\n        var responseApi = express();\n        responseApi.use(bodyParser.json());\n        responseApi.post(\"/add\",(request,response) => {\n            var json = request.body;\n            this.responseHandler.mapResponse(json.path, json.method, json.responseHttpStatus, json.responseBody, json.responseHeaders || {});\n            this.setCacheHeaders(response);\n            response.send('{\"result\" : \"OK\"}');\n        });\n        responseApi.post(\"/list\",(request,response) => {\n            var json = request.body;\n            var requests = this.responseHandler.getResponses(json.path, json.method,json.status)\n            this.setCacheHeaders(response);\n            response.json(requests);\n        });\n        responseApi.get(\"/reset\",(request,response)=>{\n            this.responseHandler.reset();\n            response.status(200);\n            this.setCacheHeaders(response);\n            response.set(\"Content-Type\", \"application/json\");\n            response.send('{\"result\" : \"OK\"}');\n        });\n\n        var mockApi = express();\n        mockApi.use(bodyParser.json());\n        mockApi.post(\"/*\",(request,response)=>{\n            console.log(\"Handle POST\");\n            this.handleRequest(request, \"POST\", response);\n        });\n        mockApi.get(\"/*\",(request,response)=>{\n            console.log(\"Handle GET\");\n            this.handleRequest(request, \"GET\", response);\n        });\n\n        app.use(\"/responses\",responseApi);\n        app.use(this.mockApiPath,mockApi);\n\n        var welcome = express();\n        welcome.get(\"/\",(req,res)=>{\n            res.send(\"Welcome!\");\n        });\n        app.use(\"/\",welcome);\n\n        this.server = app.listen(app.get('port'), () => {\n            var port = this.server.address().port;\n            console.log('Magic happens on port ' + port);\n            this.started = true;\n        });\n    }\n    setGlobalHeaders(request, response) {\n        if(this.options.useRequestHostAsAllowOrigin) {\n            response.set(\"Access-Control-Allow-Origin\",request.headers.host)\n        }\n        if(this.options.headers) {\n            for(var h in this.options.headers) {\n                response.set(h,this.options.headers[h]);\n            }\n        }\n    }\n\n    handleRequest(request, method, response) {\n        var apiResponse = this.responseHandler.onRequest(request.url,method,request.body,null);\n        if (apiResponse) {\n            if (apiResponse.responseHeaders) {\n                for (var x in response.responseHeaders) {\n                    response.set(x, response.responseHeaders[x]);\n                }\n            }\n            this.setCacheHeaders(response);\n            console.log(\"Sending response = \", apiResponse.responseBody);\n            response.status(apiResponse.responseHttpStatus);\n            if(apiResponse.responseBody) {\n                response.json(apiResponse.responseBody);\n            } else {\n                response.send();\n            }\n\n        } else {\n            this.notFound(response, request);\n        }\n    }\n\n    setCacheHeaders(response) {\n        response.header('Cache-Control', 'no-cache, no-store, must-revalidate');\n        response.header('Expires', '-1');\n        response.header('Pragma', 'no-cache');\n    }\n\n    notFound(response, request) {\n        response.status(404).send(\"No response mapped for \" + request.url + \" available: \" + this.responseHandler.getMappedPaths());\n    }\n\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/MockRestApiServer.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"body-parser\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"cors\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"mock-response-handler\"\n ** module id = 5\n ** module chunks = 0\n **/"],"sourceRoot":""}